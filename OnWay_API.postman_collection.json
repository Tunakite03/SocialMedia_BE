{
   "info": {
      "_postman_id": "onway-api-collection",
      "name": "OnWay API Collection",
      "description": "Complete API collection for OnWay Backend with error handling and authentication",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
   },
   "auth": {
      "type": "bearer",
      "bearer": [
         {
            "key": "token",
            "value": "{{auth_token}}",
            "type": "string"
         }
      ]
   },
   "event": [
      {
         "listen": "prerequest",
         "script": {
            "type": "text/javascript",
            "exec": [""]
         }
      },
      {
         "listen": "test",
         "script": {
            "type": "text/javascript",
            "exec": [""]
         }
      }
   ],
   "variable": [
      {
         "key": "base_url",
         "value": "http://localhost:8080/api/v1",
         "type": "string"
      },
      {
         "key": "auth_token",
         "value": "",
         "type": "string"
      },
      {
         "key": "user_id",
         "value": "",
         "type": "string"
      }
   ],
   "item": [
      {
         "name": "ðŸ” Authentication",
         "item": [
            {
               "name": "Register User",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "if (pm.response.code === 201) {",
                           "    const response = pm.response.json();",
                           "    pm.collectionVariables.set('auth_token', response.data.token);",
                           "    pm.collectionVariables.set('user_id', response.data.user.id);",
                           "    pm.test('Registration successful', () => {",
                           "        pm.expect(response.success).to.be.true;",
                           "        pm.expect(response.data.token).to.not.be.empty;",
                           "    });",
                           "} else {",
                           "    pm.test('Registration failed as expected', () => {",
                           "        const response = pm.response.json();",
                           "        pm.expect(response.success).to.be.false;",
                           "        pm.expect(response.error).to.not.be.empty;",
                           "    });",
                           "}"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "POST",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"email\": \"john.doe@example.com\",\n    \"username\": \"johndoe\",\n    \"password\": \"password123\",\n    \"displayName\": \"John Doe\",\n    \"dateOfBirth\": \"1990-01-01\",\n    \"bio\": \"Software Developer\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/register",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "register"]
                  }
               },
               "response": []
            },
            {
               "name": "Login User",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "if (pm.response.code === 200) {",
                           "    const response = pm.response.json();",
                           "    pm.collectionVariables.set('auth_token', response.data.token);",
                           "    pm.collectionVariables.set('user_id', response.data.user.id);",
                           "    pm.test('Login successful', () => {",
                           "        pm.expect(response.success).to.be.true;",
                           "        pm.expect(response.data.token).to.not.be.empty;",
                           "        pm.expect(response.data.user.email).to.not.be.empty;",
                           "    });",
                           "} else {",
                           "    pm.test('Login failed', () => {",
                           "        const response = pm.response.json();",
                           "        pm.expect(response.success).to.be.false;",
                           "        pm.expect(response.error).to.not.be.empty;",
                           "    });",
                           "}"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "POST",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"email\": \"john.doe@example.com\",\n    \"password\": \"password123\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/login",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "login"]
                  }
               },
               "response": []
            },
            {
               "name": "Login - Invalid Credentials",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 401 for invalid credentials', () => {",
                           "    pm.expect(pm.response.code).to.equal(401);",
                           "});",
                           "",
                           "pm.test('Should return error message', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.equal('Invalid email or password');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "POST",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"email\": \"invalid@example.com\",\n    \"password\": \"wrongpassword\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/login",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "login"]
                  }
               },
               "response": []
            },
            {
               "name": "Get Profile",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return user profile', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.true;",
                           "    pm.expect(response.data.user).to.not.be.empty;",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "GET",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/auth/profile",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "profile"]
                  }
               },
               "response": []
            },
            {
               "name": "Update Profile",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should update profile successfully', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.true;",
                           "    pm.expect(response.message).to.equal('Profile updated successfully');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "PUT",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"displayName\": \"John Doe Updated\",\n    \"bio\": \"Updated bio - Full Stack Developer\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/profile",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "profile"]
                  }
               },
               "response": []
            },
            {
               "name": "Change Password",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should change password successfully', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.true;",
                           "    pm.expect(response.message).to.equal('Password changed successfully');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "PUT",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"currentPassword\": \"password123\",\n    \"newPassword\": \"newpassword123\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/password",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "password"]
                  }
               },
               "response": []
            },
            {
               "name": "Verify Token",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should verify token successfully', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.true;",
                           "    pm.expect(response.message).to.equal('Token verified successfully');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "GET",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/auth/verify",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "verify"]
                  }
               },
               "response": []
            },
            {
               "name": "Logout",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should logout successfully', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.true;",
                           "    pm.expect(response.message).to.equal('Logout successful');",
                           "});",
                           "",
                           "// Clear auth token after logout",
                           "pm.collectionVariables.set('auth_token', '');"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "POST",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/auth/logout",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "logout"]
                  }
               },
               "response": []
            }
         ]
      },
      {
         "name": "ðŸ§ª Error Handling Tests",
         "item": [
            {
               "name": "Register - Invalid Email",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 400 for invalid email', () => {",
                           "    pm.expect(pm.response.code).to.equal(400);",
                           "});",
                           "",
                           "pm.test('Should return validation error', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.include('Validation');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "POST",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"email\": \"invalid-email\",\n    \"username\": \"testuser\",\n    \"password\": \"password123\",\n    \"displayName\": \"Test User\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/register",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "register"]
                  }
               },
               "response": []
            },
            {
               "name": "Register - Missing Required Fields",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 400 for missing required fields', () => {",
                           "    pm.expect(pm.response.code).to.equal(400);",
                           "});",
                           "",
                           "pm.test('Should return validation error', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.include('Validation');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "POST",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"email\": \"test@example.com\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/register",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "register"]
                  }
               },
               "response": []
            },
            {
               "name": "Protected Route - No Token",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 401 for missing token', () => {",
                           "    pm.expect(pm.response.code).to.equal(401);",
                           "});",
                           "",
                           "pm.test('Should return authentication error', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.include('token');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "GET",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/auth/profile",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "profile"]
                  }
               },
               "response": []
            },
            {
               "name": "Protected Route - Invalid Token",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 401 for invalid token', () => {",
                           "    pm.expect(pm.response.code).to.equal(401);",
                           "});",
                           "",
                           "pm.test('Should return authentication error', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.include('Invalid');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "invalid_token_here",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "GET",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/auth/profile",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "profile"]
                  }
               },
               "response": []
            },
            {
               "name": "Change Password - Wrong Current Password",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 400 for wrong current password', () => {",
                           "    pm.expect(pm.response.code).to.equal(400);",
                           "});",
                           "",
                           "pm.test('Should return validation error', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.success).to.be.false;",
                           "    pm.expect(response.error).to.include('Current password is incorrect');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "auth": {
                     "type": "bearer",
                     "bearer": [
                        {
                           "key": "token",
                           "value": "{{auth_token}}",
                           "type": "string"
                        }
                     ]
                  },
                  "method": "PUT",
                  "header": [
                     {
                        "key": "Content-Type",
                        "value": "application/json"
                     }
                  ],
                  "body": {
                     "mode": "raw",
                     "raw": "{\n    \"currentPassword\": \"wrongpassword\",\n    \"newPassword\": \"newpassword123\"\n}"
                  },
                  "url": {
                     "raw": "{{base_url}}/auth/password",
                     "host": ["{{base_url}}"],
                     "path": ["auth", "password"]
                  }
               },
               "response": []
            }
         ]
      },
      {
         "name": "ðŸ”§ Health Check",
         "item": [
            {
               "name": "Health Check",
               "event": [
                  {
                     "listen": "test",
                     "script": {
                        "exec": [
                           "pm.test('Should return 200', () => {",
                           "    pm.expect(pm.response.code).to.equal(200);",
                           "});",
                           "",
                           "pm.test('Should return status OK', () => {",
                           "    const response = pm.response.json();",
                           "    pm.expect(response.status).to.equal('OK');",
                           "});"
                        ],
                        "type": "text/javascript"
                     }
                  }
               ],
               "request": {
                  "method": "GET",
                  "header": [],
                  "url": {
                     "raw": "{{base_url}}/../health",
                     "host": ["{{base_url}}"],
                     "path": ["..", "health"]
                  }
               },
               "response": []
            }
         ]
      }
   ]
}
